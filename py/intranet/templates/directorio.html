{% extends "base.html" %}
{% set active_sec = 'Tutor√≠as' %}
{% block head %}
    {% if not auth %}
        <meta http-equiv="refresh" content="0; URL=/">
    {% endif %}
{% endblock %}

{% block content %}

    {% if auth and aa.uid == 'francisco.moya' %}
    <form onsubmit="update_profesores(this); return false;">
        <div class="form-group col-md-6">
            <label for="userid">Usuario</label>
            <input id="userid" class="form-control" value="{{aa.uid}}">
        </div>
        <div class="form-group col-md-6">
            <label for="password">Password</label>
            <input id="password" type="password" class="form-control">
        </div>    
        <button id="actualizar" class="btn btn-primary" type="submit">
            Actualizar
            <span id="pending" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
        </button>
    </form>
    <div id="result"></div>

    <script>
const userid = document.getElementById('userid');
const password = document.getElementById('password');

function update_profesores(form) {
    pending(true);
    var req = new XMLHttpRequest();
    req.onload  = function() {
        pending(false);
        document.getElementById("result").innerHTML = req.responseText;
    };
    req.open('POST', "/v2/directorio/update_profesores/", true);
    req.setRequestHeader("Content-Type", "application/json");
    req.send(JSON.stringify({'userid': userid.value, 'password': password.value}));
}

function pending(v) {
    const img = document.querySelector("#pending");
    img.style.display = (v ? "block": "none");
    const b = document.querySelector('#actualizar');
    b.disabled = v;
}

pending(false);
    </script>
    {% endif %}
 
{% endblock %}
